#!/bin/bash

# Most lines were generated by:
#   https://github.com/nsmfoo/antivmdetection

if [ "${#}" -eq 0 ] ; then
  echo "[*] Please add vm name!"
  echo "[*] Available vms:"
  /usr/bin/VBoxManage list vms | awk -F'"' {' print $2 '} | sed 's/"//g'
  exit 1
fi

if ! /usr/bin/VBoxManage showvminfo "${1}" > /dev/null 2>&1 ; then
  echo "[*] Sorry, given vm does not exist!"
fi

readonly VM="${1}"

if [ ! -f "${HOME}/VirtualBox VMs/${VM}/ESPRIMOP910_DSDT.bin" ] ; then
	echo "[*] Please copy ESPRIMOP910_DSDT.bin to ${HOME}/VirtualBox VMs/${VM}/ first!"
	exit 1
fi

/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBIOSReleaseDate '12/17/2012'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBIOSReleaseMajor '1'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBIOSReleaseMinor '19'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBIOSVendor 'FUJITSU // American Megatrends Inc.'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBIOSVersion 'V4.6.5.3 R1.19.0 for D3162-A1x'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBoardAssetTag '                      '
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBoardBoardType '10'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBoardLocInChass '                      '
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBoardProduct 'D3162-A1'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBoardSerial '34BF1C06'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBoardVendor 'FUJITSU'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiBoardVersion 'S26361-D3162-A1'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiChassisAssetTag '                                        '
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiChassisSerial 'A1B4909FF9'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiChassisType '6'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiChassisVendor 'FUJITSU'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiChassisVersion 'C$PXW4'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiProcManufacturer 'Intel(R) Corporation'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiProcVersion 'Intel(R) Core(TM) i7-3770 CPU @ 3.40GHz'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiSystemFamily 'Not Specified'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiSystemProduct 'ESPRIMO P910'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiSystemSKU 'S26361-Kxxx-Vyyy'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiSystemSerial 'BC59F9EA5D'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiSystemUuid '4A6692B9-FB38-4EAC-86D9-E415C78BB29E'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiSystemVendor 'FUJITSU'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/pcbios/0/Config/DmiSystemVersion '                      '
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/ahci/0/Config/Port0/ModelNumber 'ST1000DM003-1CH162'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/ahci/0/Config/Port0/SerialNumber '474F58C1'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/ahci/0/Config/Port0/FirmwareRevision 'CC45'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/ahci/0/Config/Port1/ATAPIVendorId 'HL-DT-ST'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/ahci/0/Config/Port1/ATAPIRevision 'TF03'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/ahci/0/Config/Port1/ATAPIProductId 'DVDRAM GHA2N'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/ahci/0/Config/Port1/ATAPISerialNumber '5AA0289FFA0'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/acpi/0/Config/CustomTable "${HOME}/VirtualBox VMs/${VM}/DSDT.bin"
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/acpi/0/Config/AcpiOemId 'FTS'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/acpi/0/Config/AcpiCreatorId 'INTL'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/Devices/acpi/0/Config/AcpiCreatorRev '20091112'
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/00000001/ecx 0x57982203	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000002/eax 0x65746e49	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000002/ebx 0x2952286c	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000002/ecx 0x726f4320	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000002/edx 0x4d542865	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000003/eax 0x37692029	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000003/ebx 0x3737332d	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000003/ecx 0x50432030	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000003/edx 0x20402055	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000004/eax 0x30342e33	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000004/ebx 0x207a4847	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000004/ecx 0x20202020	
/usr/bin/VBoxManage setextradata "${VM}" VBoxInternal/CPUM/HostCPUID/80000004/edx 0x00202020
/usr/bin/VBoxManage modifyvm "${VM}" --macaddress1 001999e4a6d2

exit 0